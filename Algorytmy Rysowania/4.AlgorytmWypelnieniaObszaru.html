<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
</head>
<body>
<style> body { background-color:#ccc; } </style>
    <script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.7/p5.js"></script>
    <body oncontextmenu="return false;">
    <script type="text/javascript">
        function setup() {
            pixelDensity(1);
            createCanvas(512,512);
            background(255);
        }
        var last_x=-1;
        var last_y=-1;
        function mouseDragged() {  
            if(mouseButton != LEFT) return;
            if(last_x>0) {
                line(last_x,last_y,mouseX,mouseY);
            }
            last_x=mouseX;
            last_y=mouseY;
        }
        function mouseReleased() {
            last_x=last_y=-1;
            if(mouseButton == RIGHT) {
                loadPixels();
                flood_fill(mouseX,mouseY);
                updatePixels();
            }
        }
        function set_pixel(x,y,c) {
            idx=(y*512+x)*4;
            pixels[idx]=c;
            pixels[idx+1]=c;
            pixels[idx+2]=c;
            pixels[idx+3]=255;
        }
        
        function get_pixel(x,y) {
            idx=(y*512+x)*4;
            return pixels[idx];
        }
        
        //właściwa funkcja do wypełniania
        function flood_fill(x,y) {
            // stworzenie stosu przez zainicjowanie tablicy
            stos=[];

            // wrzucenie współrzędnych kliknięcia myszy (x,y), podane w argumencie funkcji
            stos.push([x,y]);

            cnt = 10000;
            // pętla while (póki stos nie jest pusty) czyli długość > 0
            while (stos.length > 0 && cnt>0) {
                //zdejmij ze stosu ostatnie współrzędne
                [x, y] = stos.pop();
                // jeśli wsółrędne nie mieszczą się na ekranie 
                if (x < 0 && width < x && y < 0 && height < y) {
                    continue;
                }
                // jeśli pobrany kolor nie jest biały
                if (get_pixel(x, y) != 255) {
                    continue;
                }
                set_pixel(x, y, 200);
                // dodajemy do stosu
                // powyżej (x,y-1)
                stos.push([x, y - 1]);
                // poniżej (x,y+1),
                stos.push([x, y + 1]);
                // z lewej (x-1,y)
                stos.push([x - 1, y]);
                // z prawej (x+1,y)
                stos.push([x + 1, y]);
                cnt--;
            }
        }
    </script>
    <a href="."><button>&#x2190; back </button></a></br></br>
</body>
</html>